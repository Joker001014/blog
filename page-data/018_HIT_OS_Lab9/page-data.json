{"componentChunkName":"component---src-templates-blog-post-js","path":"/018_HIT_OS_Lab9/","result":{"data":{"site":{"siteMetadata":{"title":"JokerDebug"}},"markdownRemark":{"id":"5b72faa2-f907-5295-ae99-c950f530818a","excerpt":"Github代码仓库链接 本节将更新哈工大《操作系统》课程第九个 Lab 实验 proc文件系统的实现。按照实验书要求，介绍了非常详细的实验操作流程，并提供了超级无敌详细的代码注释。 实验目的： 掌握虚拟文件系统的实现原理； 实践文件、目录、文件系统等概念。 实验任务： 在 Linux 0.11 上实现 procfs…","html":"<p><a href=\"https://github.com/Joker001014/HIT-OSlab\">Github代码仓库链接</a></p>\n<p>本节将更新哈工大《操作系统》课程第九个 Lab 实验 <strong>proc文件系统的实现</strong>。按照实验书要求，介绍了非常详细的实验操作流程，并提供了超级无敌详细的代码注释。</p>\n<p><strong>实验目的：</strong></p>\n<blockquote>\n<ul>\n<li>掌握虚拟文件系统的实现原理；</li>\n<li>实践文件、目录、文件系统等概念。</li>\n</ul>\n</blockquote>\n<p><strong>实验任务：</strong></p>\n<blockquote>\n<p>在 Linux 0.11 上实现 procfs（proc 文件系统）内的 psinfo 结点。当读取此结点的内容时，可得到系统当前所有进程的状态信息。例如，用 cat 命令显示 /proc/psinfo 的内容，可得到：</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 455px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/2a1389925599264c281aad7fc60bbeb9/379c3/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.87341772151899%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABm0lEQVR42pWS204aQRyH9wV6o6aCUcpyWsBFYKkPYAwxnnqythIWl7XFBtqi8dpEowYSE3vTmBYUJbW9atpnaHyW+gwcAnwdxitvJJ1kMpnD75vvPxmlXD5iLbWKZZu8zdlY2TS5zTfYGxlK5UP+tym2ncHnd+PxuXg8HSNuRAhPBggEPSSTM5RKR3wsFli30hSL79nZ2RJjgazI5TY32Nr+IPfzhXfs7++i5PM5VHWcUNjPVDQsocGQDy3oxUhEcHsm6F96dlbhsl7j+48r6vULTk8/U6l85erbpVyvXZzz+9dPlGzWZNQxTCyu4xbgmDD0C+PEdBzD0Bl1jnBeq8pyOp3O4JIty8QhQpGpEF7fI2mpCisjEUXXNcYnnFSrX+ThVqslofd1+YYul0Ma9svsAwOah2hMl6X7Ayonn44lsNvrDTZcffWcoeEHIuwVNg8lwDk2IoCTaJoq7RcW57i5+SsDvQFQ5eBgj+TcLGnzNctPFkiJL7S0PC/mKVZePuPFylPMzBrX139uLbvdO4B2u02z2ZS90WjwD0k4r/tp2CHLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/2a1389925599264c281aad7fc60bbeb9/379c3/1.png\"\n        srcset=\"/blog/static/2a1389925599264c281aad7fc60bbeb9/c26ae/1.png 158w,\n/blog/static/2a1389925599264c281aad7fc60bbeb9/6bdcf/1.png 315w,\n/blog/static/2a1389925599264c281aad7fc60bbeb9/379c3/1.png 455w\"\n        sizes=\"(max-width: 455px) 100vw, 455px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><code class=\"language-text\">cat</code>：显示文件内容、将文件内容合并输出到终端或其他文件。</li>\n</ul>\n<blockquote>\n<ul>\n<li>procfs，它是一个<code class=\"language-text\">虚拟文件系统</code>，通常被 mount（挂载） 到 /proc 目录上，通过虚拟文件和虚拟目录的方式提供访问系统参数的机会；</li>\n<li>这些虚拟的文件和目录并没有真实地存在在磁盘上，而是内核中各种数据的一种直观表示，是完全存在于内存中的。虽然是虚拟的，但它们都可以通过标准的系统调用（open()、read() 等）访问。</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>实现思路：\r\nLinux 0.11 使用的是 Minix 的文件系统，这是一个典型的基于 inode 的文件系统，《注释》一书对它有详细描述。它的每个文件都要对应至少一个 inode，而 <code class=\"language-text\">inode</code> 中记录着文件的各种属性，包括文件类型。文件类型有普通文件、目录、字符设备文件和 9b 块设备文件等。在内核中，每种类型的文件都有不同的处理函数与之对应。我们可以增加一种新的文件类型——proc 文件，并在相应的处理函数内实现 procfs 要实现的功能。</p>\n</blockquote>\n<h3>一、增加 proc 文件</h3>\n<p>1、在 <code class=\"language-text\">include/sys/stat.h</code> 文件定义中新增 <code class=\"language-text\">proc</code> 文件的 宏定义 和 测试宏：</p>\n<div class=\"gatsby-highlight\" data-language=\"h\"><pre class=\"language-h\"><code class=\"language-h\">//proc文件的宏定义/宏函数 \r\n#define S_IFPROC 0030000 \r\n#define S_ISPROC(m) (((m) &amp; S_IFMT) == S_IFPROC) //测试m是否是proc文件</code></pre></div>\n<p>2、修改 <code class=\"language-text\">fs/namei.c</code> 文件，让<code class=\"language-text\">mknod()</code> 支持新的文件类型</p>\n<blockquote>\n<p>在 <code class=\"language-text\">proc</code> 目录下创建<code class=\"language-text\">psinfo</code>、<code class=\"language-text\">hdinfo</code>、<code class=\"language-text\">inodeinfo</code>等文件，需要调用<code class=\"language-text\">mknod</code> 函数 -> <code class=\"language-text\">sys_mknod</code> 函数，则需要让它支持新的文件类型，成功创建<code class=\"language-text\">inode</code></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span> <span class=\"token function\">sys_mknod</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> filename<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> mode<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> dev<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n<span class=\"token comment\">//  ....</span>\r\n\tinode<span class=\"token operator\">-></span>i_mode <span class=\"token operator\">=</span> mode<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">S_ISBLK</span><span class=\"token punctuation\">(</span>mode<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">S_ISCHR</span><span class=\"token punctuation\">(</span>mode<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">S_ISPROC</span><span class=\"token punctuation\">(</span>mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n        inode<span class=\"token operator\">-></span>i_zone<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dev<span class=\"token punctuation\">;</span>\r\n    inode<span class=\"token operator\">-></span>i_mtime <span class=\"token operator\">=</span> inode<span class=\"token operator\">-></span>i_atime <span class=\"token operator\">=</span> CURRENT_TIME<span class=\"token punctuation\">;</span></code></pre></div>\n<p>3、修改 <code class=\"language-text\">init/main.c</code> 文件，创建进程<code class=\"language-text\">proc</code>文件\r\nprocfs 的初始化工作应该在根文件系统挂载之后开始，包括两个步骤：</p>\n<ol>\n<li>建立 /proc 目录，通过用户态调用<code class=\"language-text\">mkdir()</code> -> <code class=\"language-text\">sys_mkdir()</code>；</li>\n<li>建立 /proc 目录下的各个结点，通过用户态调用<code class=\"language-text\">mknod()</code> -> <code class=\"language-text\">sys_mknod()</code>。</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token comment\">/* 新增用户态接口 mkdir 和 mknode 系统调用*/</span>\r\n<span class=\"token function\">_syscall2</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span>mkdir<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span>name<span class=\"token punctuation\">,</span><span class=\"token class-name\">mode_t</span><span class=\"token punctuation\">,</span>mode<span class=\"token punctuation\">)</span>\r\n<span class=\"token function\">_syscall3</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span>mknod<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span>filename<span class=\"token punctuation\">,</span><span class=\"token class-name\">mode_t</span><span class=\"token punctuation\">,</span>mode<span class=\"token punctuation\">,</span><span class=\"token class-name\">dev_t</span><span class=\"token punctuation\">,</span>dev<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> pid<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span>drive_info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/dev/tty0\"</span><span class=\"token punctuation\">,</span>O_RDWR<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token function\">dup</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token function\">dup</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">/* 创建proc目录 和 文件 */</span>\r\n    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">0755</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">mknod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc/psinfo\"</span><span class=\"token punctuation\">,</span>S_IFPROC<span class=\"token operator\">|</span><span class=\"token number\">0444</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">mknod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc/hdinfo\"</span><span class=\"token punctuation\">,</span>S_IFPROC<span class=\"token operator\">|</span><span class=\"token number\">0444</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">mknod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc/inodeinfo\"</span><span class=\"token punctuation\">,</span>S_IFPROC<span class=\"token operator\">|</span><span class=\"token number\">0444</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">//  ....</span></code></pre></div>\n<ul>\n<li>参数 <code class=\"language-text\">0755</code>（对应 rwxr-xr-x），表示只允许 root 用户改写此目录</li>\n<li>参数 <code class=\"language-text\">S_IFPROC|0444</code> 做为 mode 值，表示这是一个 proc 文件，权限为 0444（r--r--r--），对所有用户只读。</li>\n<li>mknod() 的第三个参数 <code class=\"language-text\">dev</code> 用来说明结点所代表的设备编号。</li>\n</ul>\n<blockquote>\n<p>此时若调用 <code class=\"language-text\">cat /proc/psinfo</code> 会报错，因为内核在对 psinfo 进行读操作时不能正确处理，所以还要创建 <code class=\"language-text\">proc_read</code> 函数，并在 <code class=\"language-text\">sys_read()</code> 中打补丁。</p>\n</blockquote>\n<h3>二、实现 proc 文件可读</h3>\n<p>1、创建 <code class=\"language-text\">fs/proc.c</code> 文件，实现根据设备编号，把不同的内容写入到用户空间的 buf，使得 <code class=\"language-text\">cat</code> 指令可以正确获取 <code class=\"language-text\">proc</code> 文件内容。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;linux/kernel.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;linux/sched.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;asm/segment.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;linux/fs.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdarg.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\r\n\r\n<span class=\"token comment\">// 内联汇编定义一个宏，用于在位图中测试特定位是否被设置</span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">set_bit</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>bitnr<span class=\"token punctuation\">,</span>addr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> </span><span class=\"token punctuation\">\\</span>\r\n<span class=\"token expression\"><span class=\"token keyword\">register</span> <span class=\"token keyword\">int</span> __res <span class=\"token punctuation\">;</span> </span><span class=\"token punctuation\">\\</span>\r\n<span class=\"token expression\"><span class=\"token function\">__asm__</span><span class=\"token punctuation\">(</span></span><span class=\"token string\">\"bt %2,%3;setb %%al\"</span><span class=\"token expression\"><span class=\"token operator\">:</span></span><span class=\"token string\">\"=a\"</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>__res<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span></span><span class=\"token string\">\"a\"</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"token string\">\"r\"</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>bitnr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"token string\">\"m\"</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span><span class=\"token punctuation\">\\</span>\r\n<span class=\"token expression\">__res<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span></span>\r\n\r\n<span class=\"token comment\">// 定义一个缓冲区，用于存储进程、硬盘或 inode 信息，大小为 4096 字节</span>\r\n<span class=\"token keyword\">char</span> proc_buf<span class=\"token punctuation\">[</span><span class=\"token number\">4096</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token char\">'\\0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// 声明一个外部函数 vsprintf，用于将格式化输出写入字符串</span>\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">int</span> <span class=\"token function\">vsprintf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> fmt<span class=\"token punctuation\">,</span> va_list args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">//Linux0.11没有sprintf()，该函数是用于输出结果到字符串中的，所以就实现一个，这里是通过vsprintf()实现的。</span>\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>fmt<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    va_list args<span class=\"token punctuation\">;</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    i<span class=\"token operator\">=</span><span class=\"token function\">vsprintf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 获取进程信息函数，并将其格式化写入 proc_buf</span>\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_psinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> read <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"pid\\tstate\\tfather\\tcounter\\tstart_time\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">task_struct</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">// 遍历所有进程</span>\r\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>FIRST_TASK <span class=\"token punctuation\">;</span> p <span class=\"token operator\">&lt;=</span> <span class=\"token operator\">&amp;</span>LAST_TASK <span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>p<span class=\"token punctuation\">)</span>\r\n     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span>\r\n     <span class=\"token punctuation\">{</span>\r\n\t     <span class=\"token comment\">// 进程ID 进程状态 父进程ID 时间片 启动时间</span>\r\n         read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%d\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>pid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%d\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%d\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>father<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%d\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>counter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"%d\\n\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>start_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n     <span class=\"token punctuation\">}</span>\r\n     <span class=\"token keyword\">return</span> read<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 获取硬盘信息（参考fs/super.c mount_root()函数）</span>\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_hdinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> read <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span>used<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">super_block</span> <span class=\"token operator\">*</span> sb<span class=\"token punctuation\">;</span>\r\n    sb<span class=\"token operator\">=</span><span class=\"token function\">get_super</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x301</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">/*磁盘设备号 3*256+1*/</span>\r\n    <span class=\"token comment\">/*Blocks信息：总块数、已用块数、空闲块数*/</span> \r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Total blocks:%d\\n\"</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_nzones<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    used <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    i<span class=\"token operator\">=</span>sb<span class=\"token operator\">-></span>s_nzones<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">--</span>i <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">set_bit</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">&amp;</span><span class=\"token number\">8191</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_zmap<span class=\"token punctuation\">[</span>i<span class=\"token operator\">>></span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>b_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n            used<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Used blocks:%d\\n\"</span><span class=\"token punctuation\">,</span>used<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Free blocks:%d\\n\"</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_nzones<span class=\"token operator\">-</span>used<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">/*Inodes 信息：inode数量、已用/空闲inode数量*/</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Total inodes:%d\\n\"</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_ninodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    used <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    i<span class=\"token operator\">=</span>sb<span class=\"token operator\">-></span>s_ninodes<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">--</span>i <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">set_bit</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">&amp;</span><span class=\"token number\">8191</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_imap<span class=\"token punctuation\">[</span>i<span class=\"token operator\">>></span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>b_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n            used<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Used inodes:%d\\n\"</span><span class=\"token punctuation\">,</span>used<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"Free inodes:%d\\n\"</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_ninodes<span class=\"token operator\">-</span>used<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n     <span class=\"token keyword\">return</span> read<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 获取inode信息，inode 号和第一个数据区块号</span>\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_inodeinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> read <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">super_block</span> <span class=\"token operator\">*</span> sb<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">m_inode</span> <span class=\"token operator\">*</span>mi<span class=\"token punctuation\">;</span>\r\n    sb<span class=\"token operator\">=</span><span class=\"token function\">get_super</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x301</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">/*磁盘设备号 3*256+1*/</span>\r\n    i<span class=\"token operator\">=</span>sb<span class=\"token operator\">-></span>s_ninodes<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">++</span>i <span class=\"token operator\">&lt;</span> sb<span class=\"token operator\">-></span>s_ninodes<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">set_bit</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">&amp;</span><span class=\"token number\">8191</span><span class=\"token punctuation\">,</span>sb<span class=\"token operator\">-></span>s_imap<span class=\"token punctuation\">[</span>i<span class=\"token operator\">>></span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>b_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            mi <span class=\"token operator\">=</span> <span class=\"token function\">iget</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x301</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            read <span class=\"token operator\">+=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token operator\">+</span>read<span class=\"token punctuation\">,</span><span class=\"token string\">\"inr:%d;zone[0]:%d\\n\"</span><span class=\"token punctuation\">,</span>mi<span class=\"token operator\">-></span>i_num<span class=\"token punctuation\">,</span>mi<span class=\"token operator\">-></span>i_zone<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token function\">iput</span><span class=\"token punctuation\">(</span>mi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>read <span class=\"token operator\">>=</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">)</span> \r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n     <span class=\"token keyword\">return</span> read<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// proc文件读取函数，根据设备号决定读取信息，并将读取的信息复制到用户空间的缓冲区</span>\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">proc_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> dev<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> <span class=\"token operator\">*</span> pos<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> count<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    \r\n     <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>pos <span class=\"token operator\">%</span> <span class=\"token number\">1024</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dev <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token function\">get_psinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dev <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token function\">get_hdinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>dev <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token function\">get_inodeinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n     <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>count<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n     <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span> <span class=\"token operator\">*</span>pos <span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\0'</span><span class=\"token punctuation\">)</span>  \r\n          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span> \r\n         <span class=\"token function\">put_fs_byte</span><span class=\"token punctuation\">(</span>proc_buf<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span> <span class=\"token operator\">*</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>buf <span class=\"token operator\">+</span> i<span class=\"token operator\">+</span> <span class=\"token operator\">*</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n     <span class=\"token punctuation\">}</span>\r\n     <span class=\"token operator\">*</span>pos <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span>\r\n     <span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>2、修改 <code class=\"language-text\">fs/Makefile</code> 文件中的编译规则：</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre class=\"language-makefile\"><code class=\"language-makefile\">OBJS<span class=\"token operator\">=</span>\topen.o read_write.o inode.o file_table.o buffer.o super.o \\\r\n\tblock_dev.o char_dev.o file_dev.o stat.o exec.o pipe.o namei.o \\\r\n\tbitmap.o fcntl.o ioctl.o truncate.o proc.o\r\n\t\r\n//......\r\n<span class=\"token comment\">### Dependencies:</span>\r\n<span class=\"token target symbol\">proc.o</span> <span class=\"token punctuation\">:</span> proc.c ../<span class=\"token keyword\">include</span>/linux/kernel.h ../<span class=\"token keyword\">include</span>/linux/sched.h \\\r\n  ../<span class=\"token keyword\">include</span>/linux/head.h ../<span class=\"token keyword\">include</span>/linux/fs.h ../<span class=\"token keyword\">include</span>/sys/types.h \\\r\n  ../<span class=\"token keyword\">include</span>/linux/mm.h ../<span class=\"token keyword\">include</span>/signal.h ../<span class=\"token keyword\">include</span>/asm/segment.h</code></pre></div>\n<p>3、修改 <code class=\"language-text\">fs/read_write.c</code> 文件，在 <code class=\"language-text\">sys_read</code> 中添加对 <code class=\"language-text\">proc</code> 文件的处理函数补丁，这样<code class=\"language-text\">cat</code>指令才能成功读到内容。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*新增proc_read函数外部调用*/</span>\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">int</span> <span class=\"token function\">proc_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> dev<span class=\"token punctuation\">,</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> buf<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> count<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> <span class=\"token operator\">*</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">sys_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> fd<span class=\"token punctuation\">,</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> buf<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> count<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n<span class=\"token comment\">//  ....</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>inode<span class=\"token operator\">-></span>i_pipe<span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>file<span class=\"token operator\">-></span>f_mode<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token function\">read_pipe</span><span class=\"token punctuation\">(</span>inode<span class=\"token punctuation\">,</span>buf<span class=\"token punctuation\">,</span>count<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span>EIO<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">/*新增proc_read调用*/</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">S_ISPROC</span><span class=\"token punctuation\">(</span>inode<span class=\"token operator\">-></span>i_mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token function\">proc_read</span><span class=\"token punctuation\">(</span>inode<span class=\"token operator\">-></span>i_zone<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>file<span class=\"token operator\">-></span>f_pos<span class=\"token punctuation\">,</span>buf<span class=\"token punctuation\">,</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        \r\n<span class=\"token comment\">//  ....</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>inode->i_zone[0]，这就是 mknod() 时指定的 dev ：设备编号</li>\n<li>&#x26;file->f_pos，f_pos 是上一次读文件结束时“文件位置指针”的指向</li>\n<li>buf，指向用户空间，就是 read() 的第二个参数，用来接收数据</li>\n<li>count，就是 read() 的第三个参数，说明 buf 指向的缓冲区大小</li>\n</ul>\n<h3>三、编译并运行</h3>\n<p>1、编译并运行</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> oslab_Lab8/linux-0.11\r\n<span class=\"token function\">make</span> all\r\n<span class=\"token punctuation\">..</span>/run</code></pre></div>\n<p>2、测试结果</p>\n<p>在 Bochs 中进行测试：</p>\n<div class=\"gatsby-highlight\" data-language=\"bochs\"><pre class=\"language-bochs\"><code class=\"language-bochs\">cat /proc/psinfo\r\ncat /proc/hdinfo\r\ncat /proc/inodeinfo</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 404px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/e19e2cf16ffa7f8df55608c8d5206ea0/494f9/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.92405063291139%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfUlEQVR42oWSWY+CQBCEwfvk8gAFDJcaYzT+8vXFRGMiIaLrk/6m/WRcdnU3sR4mxdjV1V2OZJnW0B4ahmHbtud5pmn2ej0+gyCwLItPLn3fr1QqhUKhWq2WSiU4RAKB59frdYiu65RyUoTMcRxN09rt9jCDqqrdbpdLRVEgVN7FuqZLGfgZGYSz0+kITimNRAGaYrEo/YaqKILgKYZhMBrJsgzHGU1e0Gw2X8Rq7owMQnvlu2Oj0WAKwQnlMW0OQzcwJIN+v8+S5XK5VqvRCBMIStIShhQQnjB4YOSOAEmIVAeDwXg8jqIIwsyMytiEL7Z4RRRGrutSGoahIIvFgi5/K+UMT1eBH7AMkWIoyGq14pSfIf0LnJmZ3abTKYYstlwuGUH8VW+AGAGvaj6fQxh7Mpnkab+B69wT4w3NZjNyogvKVqtFqpiLgQXJn9DPIuuP9e12u1wuSZKkGTabzfF43O/3nxmu12scx6fT6XA4wHe73fl83m63aZp+AfChTvc56uDRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/e19e2cf16ffa7f8df55608c8d5206ea0/494f9/2.png\"\n        srcset=\"/blog/static/e19e2cf16ffa7f8df55608c8d5206ea0/c26ae/2.png 158w,\n/blog/static/e19e2cf16ffa7f8df55608c8d5206ea0/6bdcf/2.png 315w,\n/blog/static/e19e2cf16ffa7f8df55608c8d5206ea0/494f9/2.png 404w\"\n        sizes=\"(max-width: 404px) 100vw, 404px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"【哈工大_操作系统实验】Lab9 proc文件系统的实现","date":"October 28, 2024","description":"本文将介绍哈工大操作系统实验课Lab9 proc文件系统的实现"}},"previous":{"fields":{"slug":"/017_HIT_OS_Lab8/"},"frontmatter":{"title":"【哈工大_操作系统实验】Lab8 终端设备的控制"}},"next":null},"pageContext":{"id":"5b72faa2-f907-5295-ae99-c950f530818a","previousPostId":"d1f5cbae-a781-5527-9a6a-49f5dd153691","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}