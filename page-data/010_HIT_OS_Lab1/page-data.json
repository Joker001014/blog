{"componentChunkName":"component---src-templates-blog-post-js","path":"/010_HIT_OS_Lab1/","result":{"data":{"site":{"siteMetadata":{"title":"JokerDebug"}},"markdownRemark":{"id":"c9440984-c8ea-5088-8297-a4fec02e41b7","excerpt":"Github代码仓库链接 本系列文章主要更新哈工大《操作系统》课程对应的9个Lab实验（包括熟悉实验环境），提供了非常详细的环境配置方法以及按照指导书展开的详细操作步骤，希望对大家有所帮助。 实验的基本流程是根据实验要求编写应用程序、修改 Linux 0.11 的源代码，用 gcc 编译后，在 Bochs…","html":"<p><a href=\"https://github.com/Joker001014/HIT-OSlab\">Github代码仓库链接</a></p>\n<p>本系列文章主要更新哈工大《操作系统》课程对应的9个Lab实验（包括熟悉实验环境），提供了非常详细的环境配置方法以及按照指导书展开的详细操作步骤，希望对大家有所帮助。</p>\n<blockquote>\n<p>实验的基本流程是根据实验要求编写应用程序、修改 <strong>Linux 0.11</strong> 的源代码，用 gcc 编译后，在 Bochs 的虚拟环境中运行、调试目标代码。注：笔者是在 <code class=\"language-text\">Ubuntu20.04</code> 平台上进行实验。</p>\n</blockquote>\n<h3>一、实验工具准备：</h3>\n<table>\n<thead>\n<tr>\n<th>文件名</th>\n<th>介绍</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>hit-操作系统实验指导书.pdf</td>\n<td>哈工大OS实验指导书</td>\n</tr>\n<tr>\n<td>Linux内核完全注释(修正版v3.0).pdf</td>\n<td>赵博士对Linux v0.11 OS进行了详细全面的注释和说明</td>\n</tr>\n<tr>\n<td>file1615.pdf</td>\n<td>BIOS 涉及的中断数据手册</td>\n</tr>\n<tr>\n<td>hit-oslab-linux-20110823.tar.gz</td>\n<td>hit-oslab 实验环境</td>\n</tr>\n<tr>\n<td>gcc-3.4-ubuntu.tar.gz</td>\n<td>Linux v0.11 所使用的编译器</td>\n</tr>\n<tr>\n<td><a href=\"https://joker001014.github.io/blog/019_HIT_OS_Bochs\">Bochs 汇编级调试指令</a></td>\n<td>bochs 基本调试指令大全</td>\n</tr>\n</tbody>\n</table>\n<h3>二、实验环境配置</h3>\n<p><strong>1、文件结构</strong></p>\n<p>下载 <code class=\"language-text\">hit-oslab-linux-20110823.tar.gz</code> 压缩包，并将其解压，将得到如下文件：</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/d000a9524f70a05793eceb46cc7b88ac/748b0/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.68354430379747%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVR42n2PS6vCMBCF8+e0plLqH5S7E3f3giv3rlyL4kpBwdY+Ytu09kXPzQxWXKiBjzOTM5mZCGck4Y7HsIdDTGzbqAVXSowGg69Iy4I0bzh/qOs4EMu/BdarFfabLX5nM4TXAPPpD/zLBVEUQSn1JEkSvkvTFJ7nsQZBwF4cx7j6PsTpfIJnAp3nOByPqOsa290OZVlyUVEUTG78pmmgtQadLMvQdR3CMMS9vHOubgqCitq2ZTg29HfUnHh6b/TVp1jQujfTmRKtMzZoalVVvEE/7BP9D2hD4h9TYFaS8Z7LXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/d000a9524f70a05793eceb46cc7b88ac/f058b/1.png\"\n        srcset=\"/blog/static/d000a9524f70a05793eceb46cc7b88ac/c26ae/1.png 158w,\n/blog/static/d000a9524f70a05793eceb46cc7b88ac/6bdcf/1.png 315w,\n/blog/static/d000a9524f70a05793eceb46cc7b88ac/f058b/1.png 630w,\n/blog/static/d000a9524f70a05793eceb46cc7b88ac/748b0/1.png 868w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>• Image 文件</p>\n<blockquote>\n<p>oslab 工作在一个宿主操作系统之上，我们使用的 Linux，在宿主操作系统之上完成对 Linux0.11 的开发、修改和编译之后，在 linux-0.11 目录下会生产一个名为 Image 的文件，它就是编译之后的目标文件。\r\n该文件内已经包含引导和所有内核的二进制代码。如果拿来一张软盘，从它的 0 扇区开始，逐字节写入 Image 文件的内容，就可以用这张软盘启动一台真正的计算机，并进入 Linux0.11 内核。\r\noslab 采用 bochs 模拟器加载这个 Image 文件，模拟执行 Linux 0.11，这样省却了重新启动计算机的麻烦。</p>\n</blockquote>\n<p>• bochs 目录</p>\n<blockquote>\n<p>bochs 目录下是与 bochs 相关的执行文件、数据文件和配置文件。</p>\n</blockquote>\n<p>• run 脚本</p>\n<blockquote>\n<p>bochs 目录下是与 bochs 相关的执行文件、数据文件和配置文件。run 是运行 bochs 的脚本命令。</p>\n</blockquote>\n<p>运行后 bochs 会自动在它的虚拟软驱 A 和虚拟硬盘上各挂载一个镜像文件，<strong>软驱上挂载是linux-0.11/Image，硬盘上挂载的是 hdc-0.11.img</strong>。</p>\n<p>• hdc-0.11.img 文件</p>\n<blockquote>\n<p>hdc-0.11.img 文件的格式是 Minix 文件系统的镜像。</p>\n</blockquote>\n<p>Linux 所有版本都支持这种格式的文件系统，所以可以直接在宿主 Linux 上通过 mount 命令访问此文件内的文件，达到宿主系统和 bochs 内运行的 Linux 0.11 之间交换文件的效果。</p>\n<p><strong>2、使用方法</strong></p>\n<p>（1）进入 linux-0.11 目录进行编译</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> ~/my_space/OS_HIT/oslab/linux-0.11\r\n<span class=\"token function\">make</span> all</code></pre></div>\n<p>结尾出现 <code class=\"language-text\">sync</code> 则表示成功。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/2e195/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.810126582278485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVR42pWR2U7DMBBFnU1Zndiuk/JDXVxS3igJamv6/x9x8UxBCCkIeDjyMp6Ze8dinmb4q8flfIb3Hre3G17nGdvNBuM44ul4xMEd4JzDbrtjxscRbr/H6fmE6WX6hsiyDHmeoygKJg9UVQW6j6IIcRzzKoT4G0pp2NUK6/UDjDGo6xpt26IsCyRJgjRNGWrAfOwptoQYhgFGm1BMQ2sN2UhI2aJpGj53XQulFO+rsoTSKsQkK19UyAWDMkqildSJSNxtMveHn7Z/tW/7ngtZa6FDUZrfv2YmvhpyXtcptkfQrH5KWIrRZ5IYKSX6IIxcvgNAd6doIukpygAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/f058b/2.png\"\n        srcset=\"/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/c26ae/2.png 158w,\n/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/6bdcf/2.png 315w,\n/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/f058b/2.png 630w,\n/blog/static/f8a3085283b26156b8a89e6c7fa8ae39/2e195/2.png 782w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>（2）运行</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">..</span>/run</code></pre></div>\n<p>如果出现 Bochs 的窗口，里面显示 linux 的引导过程，最后停止在 [/usr/root/]#，表示运行成功</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/01dae/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAklEQVR42pVUTW8SURQdBhg+huFrgAFpS0tJCJjuWBMIHyGwBBeEaU2a8BHdmdSiJkWkQ/0B7uzKWDVNion8wOO9ry2RqBUXJ2fey7vnnnvveyOZ3S6eHh7iyDTxbDTC6/EYF5aFuXWOi3OLcMvv53PiGazZDK9OT/Hy5ARmr4cnnQ4G/T5GgwHOnvchdY+PcUSLF5MJPlxe4tvNDT5dX+MzMeNqscDV9wW+LH/g63KJj3RmTEmn76YYDofok9jb6RQzSvzmbALJtb0Nu2FA2dqC7PVCcjho0wXJ7YbkdEKS5XVI0hpsNpvAai8Qj8ObSkHd2YG2vw8tk4Fvb++WaV8mEfkuiCHWd/h1vRIO7u7CGQ7DzS4jEcGuaBRKKAQlFoOsKL+5ehCPDw5gkMsIBccTCRiERDKJRwSdEqg+H/yaBo2gbCKeoTLD5EYnl1Fyxt9REtJ1XaxjnIgSBoNBeDweeKnPDu7z3wQT5MhHLtiB3+8XgezETUNx0XBYhJlFeC8QCDzsNEmlqaoqDrIwB61N7X+RTqcRpnINGgaXyW7kP1yPjVEoFJDP55HL5ZCia5LNZgXf9+ueuUwu+1+QOJj7x+VyD0M0FO6j3W4XB5gZG7ehR++x0WigXC6jVCqhWCyiWq2iXq+jUqmgVqut0Gw2BVqtluB2u40OvWWGSf8C5p99U2TUyw1WqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/f058b/3.png\"\n        srcset=\"/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/c26ae/3.png 158w,\n/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/6bdcf/3.png 315w,\n/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/f058b/3.png 630w,\n/blog/static/a8b68b316a8910acdc6bacd87db2a7c0/01dae/3.png 721w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>（3）调试</p>\n<ul>\n<li>汇编级调试：OS汇编级详细的调试方法请参考文章 <a href=\"https://joker001014.github.io/blog/019_HIT_OS_Bochs\">【哈工大_操作系统】Bochs 汇编级调试方法及指令</a>。这篇博文详细介绍了 Bochs 汇编级调试的方法，同时后续设计到的 Bochs 常用指令也都可以在这篇博文中查到。</li>\n<li>C语言级调试：将会在后续使用时更新。</li>\n</ul>\n<p>（4）文件交换\r\n接下来讲解一下 Ubuntu 和 Linux 0.11 之间的文件交换如何启动。\r\n<code class=\"language-text\">开始设置文件交换之前，务必关闭所有的 Bochs 进程。</code></p>\n<p>slab 下的 hdc-0.11-new.img 是 0.11 内核启动后的根文件系统镜像文件，相当于在 bochs 虚拟机里装载的硬盘。在启动挂载之前打开 <code class=\"language-text\">hdc</code> 文件夹时显示内容如下：</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 344px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/e043196b8ec8a4a8fe057874e21b54f5/75d93/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVR42p1P226CUBDkb0yf1Ug00Zq2AiLFGq0oNX6ggPAzbZ96URJbGhXUKDHg9OxJMe1rTzKZvczs7hHkRgNG7x7dTgdDw8Cw30dTkqAqCkamCaPbgzkYoHF1BV3TMB6NYDId5Xd6G+MHE1qziTbrlUURglgsQpFkaKoKXW3xZkUsoVwSocoKWoqMG2Yu5vOo12rQWxqrSygVCris1nDbVFCtlHFdr+Mil4PguS4c28Z06sCaTGBbFouncBl43XE4k47qFuvbP7nLPKQnLek8z4OAXy9JEpxOpzP/5wlkJqRpisPhgHC9RhzHSJMUWS9bQCBdxlmcgXTnC2M27GOxQBB8wZ/PEIbReSsZ9/s9drsdX0rx8XjkvGYHUH21WnGdkH0tCkO8vb7gfTbH89MjPoPgz8Dtdovlcsk5iiI+ZLPZYMGOoGG+7/MLvwHU8L8ASXnq5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/e043196b8ec8a4a8fe057874e21b54f5/75d93/4.png\"\n        srcset=\"/blog/static/e043196b8ec8a4a8fe057874e21b54f5/c26ae/4.png 158w,\n/blog/static/e043196b8ec8a4a8fe057874e21b54f5/6bdcf/4.png 315w,\n/blog/static/e043196b8ec8a4a8fe057874e21b54f5/75d93/4.png 344w\"\n        sizes=\"(max-width: 344px) 100vw, 344px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>在 Ubuntu 上访问其内容的方法：</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> oslab\r\n<span class=\"token function\">sudo</span> ./mount-hdc     // 启动挂载脚本</code></pre></div>\n<p>成功挂载后，<code class=\"language-text\">hdc</code> 文件夹显示内容如下：</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/d84ff52f51efff3d71071a91ed5fafed/8bd7c/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.72151898734177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVR42nWPTWvCUBBF8//BIkILggt10ZXgogs/UIMuJBq0UEh0oehKDSnSNGl58b280yRQTCteGGY4M3eYMV6tKZ/ngFrpgUQrBu0Xxr0u4ltQL1eIwoDZaEKn1UJeJM3KI+/eibf5gnazQabnpyob18lrY7PdEscxQ9NEJxp3vcJxV6hE0e33iaIvdvsd9nKZG8zJmI8g4HA8MLPtnE0ti5PnoZTCyJZl0lpzlb5l+j77VZIeYfi+/2ewaCiy//08pyGlTL+IEEIQhiE/JxIrdpkGQfwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/d84ff52f51efff3d71071a91ed5fafed/f058b/5.png\"\n        srcset=\"/blog/static/d84ff52f51efff3d71071a91ed5fafed/c26ae/5.png 158w,\n/blog/static/d84ff52f51efff3d71071a91ed5fafed/6bdcf/5.png 315w,\n/blog/static/d84ff52f51efff3d71071a91ed5fafed/f058b/5.png 630w,\n/blog/static/d84ff52f51efff3d71071a91ed5fafed/8bd7c/5.png 845w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>读写完毕，不要忘了卸载这个文件系统：</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">umount</span> hdc</code></pre></div>\n<p>经过 sudo ./mount-hdc 这样处理以后，我们可以在 Ubuntu 的 hdc 目录下创建一个 xxx.c文件，然后利用 Ubuntu 上的编辑工具（如 gedit 等）实现对 xxx.c 文件的编辑工作，在编辑保存以后。</p>\n<p>执行 sudo umount hdc 后，再进入 Linux 0.11（即 run 启动 bochs 以后）就会看到这个xxx.c，这样就避免了在 Linux 0.11 上进行编辑 xxx.c 的麻烦，因为Linux 0.11 作为一个很小的操作系统，其上的编辑工具只有 vi，使用起来非常不便。</p>","frontmatter":{"title":"【哈工大_操作系统实验】Lab1 熟悉实验环境","date":"August 21, 2024","description":"本文将介绍哈工大操作系统实验课Lab1 熟悉实验环境"}},"previous":{"fields":{"slug":"/020_HIT_OS_Rigister/"},"frontmatter":{"title":"【哈工大_操作系统】x86_64 常用寄存器大全"}},"next":{"fields":{"slug":"/011_HIT_OS_Lab2/"},"frontmatter":{"title":"【哈工大_操作系统实验】Lab2 操作系统的引导"}}},"pageContext":{"id":"c9440984-c8ea-5088-8297-a4fec02e41b7","previousPostId":"5f29e94e-8132-55c7-b3d4-6a42c8a08d75","nextPostId":"24ad8171-270c-52c8-af14-cc2e10d6027e"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}