{"componentChunkName":"component---src-templates-blog-post-js","path":"/007 Lanqiaobei/","result":{"data":{"site":{"siteMetadata":{"title":"JokerDebug"}},"markdownRemark":{"id":"aa4df4cc-ad0e-5b3a-a655-bc27b6ec9411","excerpt":"Github代码仓库链接 一、前言 承接上文，本文将继续介绍剩余蓝桥杯涉及模块（串口通信、NE555以及超声波测距），为大家做出详细编程指导。 二、串口通信 串口通信是一种用于在计算机系统和外部设备之间传输数据的通信方式。它通过串行传输数据，也就是按照一个位接一个位的顺序进行传输。…","html":"<p><a href=\"https://github.com/Joker001014/LanQiaoCup\">Github代码仓库链接</a></p>\n<h2>一、前言</h2>\n<p>承接上文，本文将继续介绍剩余蓝桥杯涉及模块（串口通信、NE555以及超声波测距），为大家做出详细编程指导。</p>\n<h2>二、串口通信</h2>\n<p>串口通信是一种用于在计算机系统和外部设备之间传输数据的通信方式。它通过串行传输数据，也就是按照一个位接一个位的顺序进行传输。</p>\n<h3>1、串口通信原理剖析</h3>\n<p>本文将编写程序，实现单片机串口接收数据，并根据接收的不同数据回传不同数据。如：（此功能为某届蓝桥杯比赛题目）</p>\n<ul>\n<li>若接收到 <code class=\"language-text\">ST</code>，则回传 dat1 和 dat2 数据；</li>\n<li>若接受到 <code class=\"language-text\">PARA</code>，则回传 dat3 和 dat4 数据；</li>\n<li>若接受到其他数据，则回传 <code class=\"language-text\">ERROR</code>。</li>\n</ul>\n<p>具体实现思路：使用单片机上的串口1不断接收串口数据，若接收到则判断接收的数据类型，回传对应形式的数据。</p>\n<h3>2、核心代码</h3>\n<p><strong>串口初始化函数</strong> 可借助 STC-ISP 软件生成，选择 <code class=\"language-text\">波特率计算器</code>，配置好所需参数，如 串口1 、 8位自动重载，即可自动生成串口初始化程序。只需在后面补上 <code class=\"language-text\">ES = 1, EA = 1</code>，允许访问内部RAM和打开总中断。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/dc67c0b4d98f2d89211bac41dedbd086/898f6/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.51898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvUlEQVR42l1T21LaUBTN/39E+9KxDz5YabVeGBFEAbnLnZAQEpIAgXDRitZpV9fKtDNOmdlzSM45a6/LjjGfhvCDGSw3QN9y4IYRgsUSzmQC1/XgTaeYzkKEiwWC+RyW48Aaj+F5HsY8s9xssN5uMeO+VmM4HCJ7c4NCuYrR2IXJavcGqNdqqD88wOl0MLi+xqRchl+rw8zl4JkmTMtC7fISQ94dc697dQWv1YJRqVTQ4p+ROcSE3W3bgskmHQKN+Ryz830mg9b9PTZBkNR6uUKlXkcp9RX5w8ME1MxmMe92YfR6PQQ8JKYPZBRFUSI1RyaNRgNRGKJOBjUCOmS2WS7h2zZuyah6dob80RGq5+fo8Hk2GMDwfR8mDwpMoH02KBUL6HQ7cHhxxb1YPvJwTN9+Pz4iIvN+tYoxGe1XK+DlBW9cQ95NPDxnh3Q6jXwui2/pHD5nWnAJMiHgnkHI7DKtkQX69Qn+6eAA33mvTdAFwV6en+EL0OEhycvQp36/n7A1LRtBGMAejRLAmEnWKd+jGv0GJPHh40d8OT5OVPm07G2/RyDJE0afz+cT0A67RQzBFzu+n3A8HilzJ9+Y6utuB7y+Jimf0rtaoYCfT0/4Jcnci3jGcF0XVzT07u4O7XYbFl9uyGjHA/F6DY8sm9xzKadxe4sBx6lH+UMy/sF3Wwa20QSQVMzJMKZkI8AbRi+mGhcFJVCVTUscNrXJWJJXbDLjJGiQl2S+eleaECPkWJTZRWClUilhOSKrOb1b0WwxPz09RSqVSmwZKu04xvZvw3+1ZXA6byzYyWaamkWBaxVDBaSLxWIRhxzeI3p2cnKSNHiv4H0lgEr14uIikaqvRsPcbDZxyc9Ke2ogn1WSJG/XlK1m/1ciWbFXOaQFJqbSZ9hl2gNKU9Ja9Swb1FRflhrqWcq0qrFW7f0BOgTlXFqp2OcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"![[Pasted image 20231106221052.png]]\"\n        title=\"\"\n        src=\"/blog/static/dc67c0b4d98f2d89211bac41dedbd086/f058b/1.png\"\n        srcset=\"/blog/static/dc67c0b4d98f2d89211bac41dedbd086/c26ae/1.png 158w,\n/blog/static/dc67c0b4d98f2d89211bac41dedbd086/6bdcf/1.png 315w,\n/blog/static/dc67c0b4d98f2d89211bac41dedbd086/f058b/1.png 630w,\n/blog/static/dc67c0b4d98f2d89211bac41dedbd086/898f6/1.png 798w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// 串口1初始化函数，8位自动重装</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">UartInit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">//4800bps@12.000MHz</span>\r\n<span class=\"token punctuation\">{</span>\r\n\tPCON <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//波特率不倍速</span>\r\n\tSCON <span class=\"token operator\">=</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//8位数据,可变波特率</span>\r\n\tAUXR <span class=\"token operator\">|=</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//定时器1时钟为Fosc,即1T</span>\r\n\tAUXR <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//串口1选择定时器1为波特率发生器</span>\r\n\tTMOD <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0x0F</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//清除定时器1模式位</span>\r\n\tTMOD <span class=\"token operator\">|=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时器1为8位自动重装方式</span>\r\n\tTL1 <span class=\"token operator\">=</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时初值</span>\r\n\tTH1 <span class=\"token operator\">=</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时器重装值</span>\r\n\tET1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//禁止定时器1中断</span>\r\n\tTR1 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//启动定时器1</span>\r\n\t\r\n\tES <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 允许外部总线访问内部RAM</span>\r\n\tEA <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 打开总中断</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>串口发送函数</strong> 也很简单，只需要将发送内容存入 SBUF 缓冲区，然后等待发送（通过 <code class=\"language-text\">TI</code> 标志实现，若发送结束，<code class=\"language-text\">TI</code>将置1，故将跳出 while 循环。</p>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">//发送数据函数\r\nvoid Uart_send(u8 *str)\r\n{\r\n\tu8 *s;\r\n\t\r\n\ts = str;\r\n\t// 遍历待发送的字符串\r\n\twhile(*s != &#39;\\0&#39;)\r\n\t{\r\n\t\tSBUF = *s;\t// 发送内容存入 SBUF 缓冲区\r\n\t\twhile(!TI);\t\t// 等待发送，发送结束 TI = 1 跳出循环\r\n\t\tTI = 0;\t\t// 清除 TI 标志\r\n\t\ts++;\t\t// 指向下一位\r\n\t}\r\n}</code></pre></div>\n<p><strong>串口接收函数</strong> 接收数据函数只需判断 <code class=\"language-text\">RI</code> 标志是否为1，若为1，即可从 <code class=\"language-text\">SBUF</code> 缓冲区中读取接收到的数据。</p>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">// 串口中断服务函数\r\nvoid Uart() interrupt 4\r\n{\r\n\t// 接收到谁\r\n\tif(RI)\r\n\t{\r\n\t\tRI = 0;\t\t\t\t// 标志清零\r\n\t\tUart_rec[Uart_count++] = SBUF;       \t// 将接收数据存入 Uart_rec 数组，并将 Uart_count 统计接收个数+1\r\n\t}\r\n}</code></pre></div>\n<h3>3、整体代码</h3>\n<p>由于考虑初学者基础较为薄弱，因此将完整的 main.cpp 代码贴出来，包含中断函数、矩阵键盘、数码管显示等，并且在关键处进行了注释，希望对大家有所帮助。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// 包含头文件</span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"STC15F2K60S2.h\"</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"stdio.h\"</span></span>\r\n<span class=\"token comment\">// 数据类型定义</span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">u8</span> <span class=\"token expression\"><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">u16</span> <span class=\"token expression\"><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span></span></span>\r\n\r\nu8 Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>Uart_out<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>Uart_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 串口接收数组、串口发送数组、串口接收个数</span>\r\nu8 dat_1 <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>dat_3 <span class=\"token operator\">=</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span>dat_4 <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// 整形发送数据</span>\r\n<span class=\"token keyword\">float</span> dat_2 <span class=\"token operator\">=</span> <span class=\"token number\">24.32</span><span class=\"token punctuation\">;</span>                                    <span class=\"token comment\">// 浮点型发送数据</span>\r\n\t\r\n<span class=\"token comment\">//串口1、8位自动重装</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">UartInit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">//4800bps@12.000MHz</span>\r\n<span class=\"token punctuation\">{</span>\r\n\tPCON <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//波特率不倍速</span>\r\n\tSCON <span class=\"token operator\">=</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//8位数据,可变波特率</span>\r\n\tAUXR <span class=\"token operator\">|=</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//定时器1时钟为Fosc,即1T</span>\r\n\tAUXR <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//串口1选择定时器1为波特率发生器</span>\r\n\tTMOD <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0x0F</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//清除定时器1模式位</span>\r\n\tTMOD <span class=\"token operator\">|=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时器1为8位自动重装方式</span>\r\n\tTL1 <span class=\"token operator\">=</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时初值</span>\r\n\tTH1 <span class=\"token operator\">=</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//设定定时器重装值</span>\r\n\tET1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//禁止定时器1中断</span>\r\n\tTR1 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//启动定时器1</span>\r\n\t\r\n\tES <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n\tEA <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">//发送数据函数</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">Uart_send</span><span class=\"token punctuation\">(</span>u8 <span class=\"token operator\">*</span>str<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\tu8 <span class=\"token operator\">*</span>s<span class=\"token punctuation\">;</span>\r\n\t\r\n\ts <span class=\"token operator\">=</span> str<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token comment\">// 遍历待发送的字符串</span>\r\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>s <span class=\"token operator\">!=</span> <span class=\"token char\">'\\0'</span><span class=\"token punctuation\">)</span>\r\n\t<span class=\"token punctuation\">{</span>\r\n\t\tSBUF <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>s<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 发送内容存入 SBUF 缓冲区</span>\r\n\t\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>TI<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 等待发送，发送结束 TI = 1 跳出循环</span>\r\n\t\tTI <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 清除 TI 标志</span>\r\n\t\ts<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 指向下一位</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 串口处理函数</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">Uart_pro</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Uart_count <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\t<span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span>Uart_count<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\n'</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token punctuation\">{</span>\r\n\t\t\t<span class=\"token comment\">// 根据接收数据类型，为发送数组 Uart_out 赋不同值 </span>\r\n\t\t\t <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'S'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'T'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>                                                     <span class=\"token comment\">// ST</span>\r\n\t\t\t\t <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>Uart_out<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$%02u,%04.2f\\r\\n\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>dat_1<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>dat_2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// 注意 sprintf 传送的是int型数据，要用unsigned int</span>\r\n\t\t     <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'P'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'A'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'R'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Uart_rec<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token char\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// PARA</span>\r\n\t\t\t\t <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>Uart_out<span class=\"token punctuation\">,</span> <span class=\"token string\">\"#%02u,%02u\\r\\n\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>dat_3<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>dat_4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n\t\t     <span class=\"token keyword\">else</span>\r\n\t\t       <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>Uart_out<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ERROR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// 同时有\"\\r\\n\"才能换行</span>\r\n\t\t\t <span class=\"token comment\">// 发送数据</span>\r\n\t\t\t <span class=\"token function\">Uart_send</span><span class=\"token punctuation\">(</span>Uart_out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n\t\t     Uart_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// 清空接收个数</span>\r\n\t\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token comment\">// 串口初始化</span>\r\n\t<span class=\"token function\">UartInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\r\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\t<span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token comment\">// 串口处理函数</span>\r\n\t\t<span class=\"token function\">Uart_pro</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 串口中断服务函数</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">Uart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> interrupt <span class=\"token number\">4</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token comment\">// 接收到谁</span>\r\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>RI<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token punctuation\">{</span>\r\n\t\tRI <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\t\t\t<span class=\"token comment\">// 标志清零</span>\r\n\t\tUart_rec<span class=\"token punctuation\">[</span>Uart_count<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> SBUF<span class=\"token punctuation\">;</span>       \t<span class=\"token comment\">// 将接收数据存入 Uart_rec 数组，并将 Uart_count 统计接收个数+1</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>至此，本次 串口通信 已介绍完毕。</p>","frontmatter":{"title":"蓝桥杯单片机设计与开发_基础模块_串口通信","date":"May 27, 2021","description":"本文介绍了蓝桥杯单片机编程大赛串口通信模块的编程使用方法。"}},"previous":{"fields":{"slug":"/006 Lanqiaobei/"},"frontmatter":{"title":"蓝桥杯单片机设计与开发_基础模块_PWM"}},"next":{"fields":{"slug":"/008 Lanqiaobei/"},"frontmatter":{"title":"蓝桥杯单片机设计与开发_基础模块_NE555"}}},"pageContext":{"id":"aa4df4cc-ad0e-5b3a-a655-bc27b6ec9411","previousPostId":"359bbddb-30cb-500c-b759-cf41a8f47927","nextPostId":"cfbbc231-c0ef-5db5-8b55-10b4e4529f4e"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}