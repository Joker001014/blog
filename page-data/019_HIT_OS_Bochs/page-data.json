{"componentChunkName":"component---src-templates-blog-post-js","path":"/019_HIT_OS_Bochs/","result":{"data":{"site":{"siteMetadata":{"title":"JokerDebug"}},"markdownRemark":{"id":"6a0d6e81-d3f4-544c-ba69-9f649af7dd5a","excerpt":"Github代码仓库链接 本文将介绍一下哈工大李治军老师《操作系统》课程在完成Lab时所使用到的 Bochs 调试工具的使用方法。这是一款汇编级调试工具，打开调试模式非常简单，只需在终端下输入如下指令： 1、bochs 调试基本指令大全 功能 指令 举例 在某物理地址设置断点 b addr b 0x9000…","html":"<p><a href=\"https://github.com/Joker001014/HIT-OSlab\">Github代码仓库链接</a></p>\n<p>本文将介绍一下哈工大李治军老师《操作系统》课程在完成Lab时所使用到的 Bochs 调试工具的使用方法。这是一款汇编级调试工具，打开调试模式非常简单，只需在终端下输入如下指令：</p>\n<h3>1、<em>bochs 调试基本指令大全</em></h3>\n<table>\n<thead>\n<tr>\n<th><strong>功能</strong></th>\n<th><strong>指令</strong></th>\n<th><strong>举例</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>在某物理地址设置断点</td>\n<td>b addr</td>\n<td>b 0x90000</td>\n</tr>\n<tr>\n<td>运行到断点位置</td>\n<td>c</td>\n<td>c</td>\n</tr>\n<tr>\n<td>单步运行（遇到函数则进入）</td>\n<td>s</td>\n<td>s</td>\n</tr>\n<tr>\n<td>单步运行（遇到函数则跳过）</td>\n<td>n</td>\n<td>n</td>\n</tr>\n<tr>\n<td>继续运行上调指令</td>\n<td>回车</td>\n<td>回车</td>\n</tr>\n<tr>\n<td>显示当前所有断点信息</td>\n<td>info break</td>\n<td>info break</td>\n</tr>\n<tr>\n<td>显示所有使用的寄存器值</td>\n<td>r</td>\n<td>r</td>\n</tr>\n<tr>\n<td>显示段寄存器值</td>\n<td>sreg</td>\n<td>sreg</td>\n</tr>\n<tr>\n<td>显示控制寄存器值</td>\n<td>creg</td>\n<td>creg</td>\n</tr>\n<tr>\n<td>显示 CPU 状态信息</td>\n<td>info cpu</td>\n<td>info cpu</td>\n</tr>\n<tr>\n<td>显示浮点寄存器值</td>\n<td>fp</td>\n<td>fp</td>\n</tr>\n<tr>\n<td>退出调试模式</td>\n<td>q</td>\n<td>q</td>\n</tr>\n<tr>\n<td>查看堆栈</td>\n<td>print-stack</td>\n<td>print-stack</td>\n</tr>\n<tr>\n<td>每执行一条指令就打印CPU信息</td>\n<td>trace-reg</td>\n<td>trace-reg on</td>\n</tr>\n<tr>\n<td>查看内存物理地址内容</td>\n<td>xp /nuf addr</td>\n<td>xp /40bx 0x9013e</td>\n</tr>\n<tr>\n<td>查看线性地址内容</td>\n<td>x /nuf addr</td>\n<td>x /40bx 0x13e</td>\n</tr>\n<tr>\n<td>反汇编一段内存</td>\n<td>u start end</td>\n<td>u 0x30400 0x3040D</td>\n</tr>\n<tr>\n<td>反汇编执行的每一条指令</td>\n<td>trace-on</td>\n<td>trace-on</td>\n</tr>\n<tr>\n<td>查看 bochs 基本命令</td>\n<td>help</td>\n<td>help</td>\n</tr>\n</tbody>\n</table>\n<h3>2、 使用方法</h3>\n<p>（1）进入调试模式</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> oslab      // 进入 oslab 文件夹下\r\n./dbg-asm     // 启动 bochs 调试模式</code></pre></div>\n<p>出现如下界面，即表示成功进入boch调试模式。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/a1792/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.58227848101266%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA00lEQVR42lWQ7Y6EIAxFEYHlGxxl1I0ms+//kHdK13UzP04aAve0VPii4YuB9QkuFK4hT4hlRswFtVbknGCthdb6xmgDYwyUUhBC/COlwkhIOcA5C0/USqJSsCwLHtOEECNJM0IISCmyRCnNVUr5KTzPE6+fF773nTv24LZtJGtoreH5bHjMM8uZtpA0IVIT59wtHIaBETuJVhL08DiO/KgHEom994jXVL8Cy005eEm6sOfuCQt9LRPp2lMX9tAX8bEzOvM9Nfmbqq/gOA6s68r0Qd6ovG+N4/9W1QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/f058b/1.png\"\n        srcset=\"/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/c26ae/1.png 158w,\n/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/6bdcf/1.png 315w,\n/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/f058b/1.png 630w,\n/blog/static/429a2cdf0baedf3ac5ecd3617aa4cf95/a1792/1.png 780w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>（2）调试方法</p>\n<p>在 0x7e00 处打上断点（即setup的启动位置），并运行到断点处，出现如下界面。此时 bootsect.s 已经运行至导入 setup.s 处，但 setup.s 还未运行。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">b 0x7e00       // 在 0x7e00 处加载断点\r\nc              // 运行到断点为止</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/7d58fdd745314b3abff1297381270fb6/a8a6f/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.645569620253163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWUlEQVR42l2QzWvCQBDFN4n5skabaNW0xBilGCsWQy14UGtuzcWbHr2qFSNaCxYKRejFv/p1sq1Qenj82J3Z92aWjadTzOMYn19fXMfTCR/HI5bzOaaTCWazGZaLBd72e+y2W7zudng/HDiT83azwXq1QrxeI169gGmuiwvPg+44UG0bkq5DVFUwJkAQRCJDhWpPwyEG/T5nOBohDEOMiMndcDBAr9fDOHoGM8tlZAoFcJomFFmGJEnc6Cw9nYZxaUIlWvk8LMtCLpdD1jCgaRoUReF99Xod7IrM8tRg8oYMjGyWDHTIZCyKNKEg4IYe3pLRNT3O0PSyqkAhpshIoLok/mzi0abs7yT/JfzSIcP7cgkN2sCiQE3TUSLzJEBLpfiUSXitVgOrVCpwHRdFtwi7asOrejwpKZ7lt1p4pD8Kul202234vo+g2cQD6a7RQBAECDodRFGEb+vAq281bZoUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/7d58fdd745314b3abff1297381270fb6/f058b/2.png\"\n        srcset=\"/blog/static/7d58fdd745314b3abff1297381270fb6/c26ae/2.png 158w,\n/blog/static/7d58fdd745314b3abff1297381270fb6/6bdcf/2.png 315w,\n/blog/static/7d58fdd745314b3abff1297381270fb6/f058b/2.png 630w,\n/blog/static/7d58fdd745314b3abff1297381270fb6/40601/2.png 945w,\n/blog/static/7d58fdd745314b3abff1297381270fb6/78612/2.png 1260w,\n/blog/static/7d58fdd745314b3abff1297381270fb6/a8a6f/2.png 1516w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>需要注意的是：终端上显示的代码是下一行将要执行的，是还未执行的代码。</p>\n</blockquote>\n<p>此外，我们还可以通过单步运行来一行一行运行代码，或者查看寄存器信息。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">n              // 单步运行\r\n回车            // 继续上次的命令\r\nr              // 查看常用寄存器信息\r\nsreg           // 查看段寄存器信息\r\nq              // 退出 debug</code></pre></div>\n<p>显示段寄存器信息：</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/b46961c0c4c2af63fa5ea8daf290c085/5c6e9/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.139240506329116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXklEQVR42kWS25aDIAxFXb14QQWhctGKtu/TP5j+/2edSUJn5iFLQLLPSUKljcHtNlPcYCcLZx3GcUTd1FB9j65TqOsal8sFbdvSvoNSCh0Fn12vVzRNg/P5jKqqUAnIWqzriuPYYT4CvH88n7jf7yRi5ZzXOe9074G87yLsnMO6LBhI/A84TRMSHW45S6IllzFGSs5IKdF/A62NrFeCbtsm8HEcJDeGIM4F6AjIEAYyQGsN6wpwJxcpLZiMkfOY4j9wvWMYBmpTAapfoPdBHLD6tmVR5D7y/tehtVMRZYfUCgYyWBtdHJJ4rz4lz96Lg3meBRBIjd342cs+71kGxm4CiXOp7Jz7zTl8l3MYfDqdUH29XnS5R4qJHES5FELEsiT5cvnceCd9LYmeTHDwpIdhlLUhME+9+n6/0dOEWIVjIwdlmmVAikrxwZNQibZtwFWxOL8Ojie9huM4xO0PqtDDOOeZ6VMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在这里插入图片描述\"\n        title=\"\"\n        src=\"/blog/static/b46961c0c4c2af63fa5ea8daf290c085/5c6e9/3.png\"\n        srcset=\"/blog/static/b46961c0c4c2af63fa5ea8daf290c085/c26ae/3.png 158w,\n/blog/static/b46961c0c4c2af63fa5ea8daf290c085/6bdcf/3.png 315w,\n/blog/static/b46961c0c4c2af63fa5ea8daf290c085/5c6e9/3.png 492w\"\n        sizes=\"(max-width: 492px) 100vw, 492px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>至此，关于李治军老师的操作系统课程 bochs 使用方法已介绍完毕，更加具体的使用方法可以参考 Bochs使用手册 <a href=\"https://bochs.sourceforge.io/doc/docbook/user/index.html\">Bochs User Manual (sourceforge.io)</a>。</p>","frontmatter":{"title":"【哈工大_操作系统】Bochs 汇编级调试方法及指令","date":"August 01, 2024","description":"本文将介绍哈工大操作系统涉及到的Bochs 汇编级调试方法及指令"}},"previous":{"fields":{"slug":"/009 Lanqiaobei/"},"frontmatter":{"title":"蓝桥杯单片机设计与开发_基础模块_超声波测距"}},"next":{"fields":{"slug":"/020_HIT_OS_Rigister/"},"frontmatter":{"title":"【哈工大_操作系统】x86_64 常用寄存器大全"}}},"pageContext":{"id":"6a0d6e81-d3f4-544c-ba69-9f649af7dd5a","previousPostId":"a94ec4cc-c5e8-5490-9ddc-bfe822a34fff","nextPostId":"5f29e94e-8132-55c7-b3d4-6a42c8a08d75"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}